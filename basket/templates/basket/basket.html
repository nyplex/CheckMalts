{% extends 'base.html' %}
{% load static %}

{% block page_title %} Menu | CheckMalt {% endblock page_title %}

{% block content %}

{% include 'order/includes/item_modal.html' %}

<!-- Alert modal if bar is closed -->
<div class="pt-[70px]">
    {% if not open %}
        <div class="max-w-screen-md mx-auto w-full bg-red-300 py-4 md:rounded-md fixed top-[70px] left-[50%] translate-x-[-50%]">
            <p class="text-red-900 font-barlow text-lg text-center font-medium">
                Oups! We are not taking orders at the moment.
            </p>
        </div>
    {% endif %}
</div>

<div class="max-w-screen-md mx-auto mt-12 mb-24">
    <div class="w-full px-2 md:px-0">
        <h1 class="text-secondaryColor font-barlow font-bold text-4xl text-left">YOUR BASKET</h1>
    </div>
    <div class="max-w-[450px] min-h-[500px] mt-8 mr-auto w-full px-2 border-2 border-primaryColor rounded-lg py-2">
        {% if basket_items %}
            {% for item in basket_items %}
                <div class="w-full min-h-[100px] p-2 mr-auto flex flex-col justify-start bg-black text-primaryColor mb-2">
                    <div class="flex flex-row md:justify-start justify-between font-barlow font-normal text-xl w-full items-center">
                        <span class="mr-2 max-w-[70%]">{{ item.quantity }}x <span class="font-bold">{{ item.cocktail.friendly_name|upper }} {% if item.size %}({{ item.size }}){% endif %}</span></span>
                        <span class="ml-auto">Â£{{ item.sub_total|floatformat:2 }}</span>
                    </div>
                    <div>
                        {% if item.note %}
                            <p class="text-sm text-gray-400 font-barlow font-normal mb-2 max-w-[70%] mt-1">"{{ item.note }}"</p>
                        {% endif %}
                        <div class="ml-4 mt-2 text-base max-w-[70%]">
                            <button data-item data-item-id="{{ item.item_id }}" data-item-quantity="{{ item.quantity }}" {% if item.size %}data-item-size="{{ item.size }}"{% endif %} {% if item.note %}data-item-note="{{ item.note }}"{% endif %} class="text-center text-secondaryHoverDarker font-barlow font-semibold hover:text-secondaryColor">Edit</button>
                            <form action="{% url 'remove_from_basket' item.item_id %}" method="POST" class="inline-block">
                                {% csrf_token %}
                                {% if item.size %}
                                    <input type="hidden" name="item_size" value="{{ item.size }}">
                                {% endif %}
                                {% if item.note %}
                                    <input type="hidden" name="item_note" value="{{ item.note }}">
                                {% endif %}
                                    <input type="hidden" name="item_quantity" value="{{ item.quantity }}">
                                <button type="submit" class="text-center text-red-800 font-barlow font-semibold ml-8 hover:text-red-700">Remove</button>
                            </form>
                            
                        </div>
                    </div>
                </div>
                <hr class="border-b-1 border-b-white w-[30%] mx-auto mb-4">
            {% endfor %}
        {% endif %}
    </div>
</div>


<script src="{% static 'dist/basket.bundle.js.gz' %}"></script>

{% endblock content %}